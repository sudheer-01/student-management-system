<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Students Information Entry</title>
    <link href="enterStudentDetails.css" rel="stylesheet"/>
</head>
<body>
    <nav class="topnav">
    <div class="brand">DIMMS-HOD Panel</div>
    <div class="nav-actions">
        <a class="btn ghost small" href="/addBranchesAndSubjects.html">Branches & Subjects</a>
        <a class="btn ghost small" href="/viewFacultyRequests.html">Faculty Requests</a>
        <a class="btn ghost small" href="/enterStudentDetails.html">Student Details</a>
        <a class="btn ghost small" href="/addAndChangeExams.html">Exams</a>
        <a class="btn ghost small" href="/generateStudentReports.html">Reports</a>
        <a class="btn ghost small" href="/viewMarksUpdateRequests.html">Marks Updates</a>
        <a class="btn ghost small" href="/generateCharts.html">Performance Charts</a>
        <a class="btn ghost small" href="/studentsDataAndPwd.html">Students Data & Password</a>
    </div>
    <div class="nav-right">
        <button id="logoutBtn" class="logout-btn">Logout</button>
    </div>
    </nav>
    <div class="form-container">
        <h1>Enter Student Details</h1>
        <p id="uiMessage" class="ui-message hidden"></p>
        <div class="top-row">
            <div class="field-group">
                <label for="yearSelect">Select Year:</label>
                <select id="yearSelect">
                    <option value="">Select Year</option>
                </select>
            </div>
            <div class="field-group">
                <label for="branchSelect">Select Section:</label>
                <select id="branchSelect">
                    <option value="">Select Section</option>
                </select>
            </div>
            <div class="field-group">
                <button id="getStudentsInfo" type="button">Get details</button>
            </div>
        </div>
        <div class="mid-row">
            <div class="field-group">
                <label for="noOfRows">Enter the number of students:</label>
                <input type="number" id="noOfRows"/>

            </div>

            <div class="field-group">
                <button id="confirmRows" type="button" onclick="rowsBasedOnNumber()">Click to add rows</button>
            </div>
        </div>
         <div class="mid-row">
            <div class="field-group">
                <label for="excelFile">Upload Excel File:</label>
                <input type="file" id="excelFile" accept=".xlsx, .xls" />
            </div>
            <div class="field-group">
                <button type="button" id="importExcel">Import from Excel</button>
            </div>
        </div>
        <p id="note" style="color:#dc2626; text-align: center; font-weight: 500;">Make sure that the Excel file has the correct column headers: HallTicket Number, Student Name.</p>
        <p id="noDataMsg" style="display:none; color:#dc2626; text-align:center; font-weight:600;">
            No student data available. Please enter student details.
        </p>
        <form id="studentsForm">
            <table id="studentsInformationTable" border="1" style="display:none;">
                <thead>
                    <tr>
                       <th>S.NO</th>
                        <th>HallTicket Number</th>
                        <th>Student Name</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <div class="bottom-row">
                <button id="addRow" type="button" style="display:none;">Add Row</button>
                <input type="submit" id="save" value="Save" style="display:none;"/>
            </div>
        </form>
    </div>
    <!-- Excel parsing library (MUST come first) -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

    <!-- Your existing JS -->
     <script src="/hodAuthentication.js"></script>
    <script src="enterStudentDetails.js"></script>
</body>
</html>
